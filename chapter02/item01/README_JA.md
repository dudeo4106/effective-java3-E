# コンストラクタの代わりに静的ファクトリーメソッドを考慮しなさい

<br>

## 📌 長所 1: 名前を持つことができます。

コンストラクタに渡す媒介変数とコンストラクタだけでは返却されるオブジェクトの特性を正しく説明できません。<br>
なのでファクトリーメソッドを使った方がコードを読みやすいかもしれません。
```
BigInteger.probablePrime
```
1つのクラスにシグネチャが同じコンストラクタを複数生成することはできません。<br>
このような場合は、コンストラクタを静的ファクトリーメソッドに変え、それぞれの違いをよく表す名前をつけるのが良いでしょう。

<br>

## 📌 長所 2: 呼び出されるたびにインスタンスを新しく生成する必要はありません。

不変クラスは、インスタンスをあらかじめ作っておいたり、<br>
新しく生成したインスタンスをキャッシングして再利用するため、不必要なオブジェクト生成を避けることができます。<br>
```
Boolean.valueOf(boolean)
```

<br>

## 📌 長所 3: 返却タイプの下位タイプオブジェクトを返却できる能力があります。

まず、クラスで作るオブジェクトのクラスを選択できるようにする「ものすごい柔軟性」をプレゼントします。<br>
APIを生成する際、この柔軟性を応用すれば、実装クラスを公開しなくてもそのオブジェクトを返却することができ、APIを小さく保つことができます。
<br>
`java.util.Collections`は45クラスを公開していないため、APIの外見をはるかに小さくすることができました。<br>
この言葉はインターフェースだけで扱われることになることを意味します。<br>
プログラマーは明示したインターフェイス通りに動作するオブジェクトを得ることを知っているので、あえて別途の文書を探しながら実際の実装クラスが何なのか調べなくてもいい。<br>
そこで、publicとして提供するAPIを減らしただけでなく、概念的な重さまで減らすことができました。

<br>

## 📌 長所 4: リターンするオブジェクトのクラスが入力媒介変数によって毎回異なる場合があります。

クライアントは、ファクトリーが渡すオブジェクトがどのクラスのインスタンスなのかを知る必要もなく知る必要もありません。<br>
例えば、OpenJDKでEnumSetの元素が64個以下の場合はRegularEnumSetを65個以上の場合はJumboEnumSetのインタータンスを返します。<br>
このようなオブジェクトタイプは露出しませんので今後のJDKの変化に応じて新しいタイプを造ったり従来のタイプを造ったりしても問題ありません。

<br>

## 📌 長所 5: 静的ファクトリーメソッドを作成する時点では、返却するオブジェクトのクラスが存在しなくても良いです。

これらの柔軟さは、サービスプロバイダフレームワーク（Service Provider Framework）を作る根幹となり、代表的なJDBC を例として挙げる。<br>
サービスプロバイダフレームワークは3つのコアコンポーネントで構成されます。<br>
```
● 実装体の動作を定義するサービスインタフェース
● 提供者が実装体登録する際に使用する提供者登録API
● クライアントがサービスのインスタンスを取得する際に使用するサービスアクセスAPI
```
付加的には、サービスインタフェースのインスタンスを提供するサービスプロバイダインタフェースを作ることもできますが、それがなければリフレクションを使って生成してくれる<br>
<br>
JDBCではですね
<br>
```
● Connectionがサービスインタフェースです
● DriverManager.registerDriver()가 제공자 등록 API
● DriverManager.getConnection()がサービスアクセスAPI
```
の役割を果たします。<br>

Java6からはJava.util.ServiceLoaderという一般的な用途のサービスプロバイダを提供しますが、JDBCがそれより以前に作られたので、JDBCはServiceLoaderを使用することはありません。

<br>

## 📌 短所 1: 継承にはPublicやProtectedコンストラクタが必要なので、静的ファクトリーメソッドさえ提供すれば下位クラスを作ることができません。

したがって、Collectionsフレームワークで提供される利便性実現体(java.util.Collections)は継承できません。 <br>
ある意味、この制約は継承よりもコンポジットの使用を誘導し、不変のタイプにするためにはこの制約を守ることが必要という点で、メリットとして受け入れられるかもしれません。

<br>

## 📌 短所 2: 静的ファクトリーメソッドはプログラマーが見つかりにくい。

コンストラクタはJavadocの上部に集まって表示されますが、staticファクトリーメソッドはAPI文書では特に扱いません。<br>
ですから、クラスやインタフェース文書上段のファクトリーメソッドに対する文書を提供すると良いでしょう。

<br>